[{"id":"dd7c3d4d.544e1","type":"inject","z":"6e1cdd6e.93025c","name":"connect","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":185.71429443359375,"y":108.5714340209961,"wires":[["b53e3116.967c1"]]},{"id":"b53e3116.967c1","type":"function","z":"6e1cdd6e.93025c","name":"PRODUCAO","func":"var mssql = global.get('mssql');\n\nvar PRODUCAO = new mssql.Connection(\"mssql://financeiro:financeiro@localhost/FINANCEIRO\", function(err) {\n    if (err) {\n        console.dir('-------------> ERRO NA CONEXAO PRODUCAO !!!!!! <-------------')\n    } else {\n        global.set('PRODUCAO', PRODUCAO);\n        console.dir('CONECTADO PRODUCAO !')\n        \n        PRODUCAO.on('error', function(err) {\n            node.error({payload: err || { erro: 9996, mensagem: 'Erro desconhecido na conexão'}})\n        });\n        \n    }\n});\n","outputs":1,"noerr":0,"x":435.71429443359375,"y":108.5714340209961,"wires":[["a0e0a2b1.523d3"]]},{"id":"a0e0a2b1.523d3","type":"debug","z":"6e1cdd6e.93025c","name":"result","active":true,"console":"false","complete":"payload","x":635.7142944335938,"y":108.5714340209961,"wires":[]},{"id":"e795e417.f370f8","type":"http in","z":"6e1cdd6e.93025c","name":"maquinas listar","url":"/api/maquina/","method":"get","swaggerDoc":"","x":173.71429443359375,"y":178.5714340209961,"wires":[["dabd7ec1.8f9dc","66f66c9a.bdb4a4"]]},{"id":"e2035132.003f5","type":"http response","z":"6e1cdd6e.93025c","name":"","x":643.7142944335938,"y":178.5714340209961,"wires":[]},{"id":"dabd7ec1.8f9dc","type":"function","z":"6e1cdd6e.93025c","name":"SQL","func":"msg.payload = [{\"id\":2,\"codigo\":\"MZCOL\",\"nome\":\"COLUNA DO MEZANINO\",\"linha\":\"MZCOL\",\"parametros\":{}},{\"id\":12,\"codigo\":\"MZCOL2\",\"nome\":\"COLUNA DO MEZANINO2\",\"linha\":\"MZCOL\",\"parametros\":{\"Encoder\":4096}},{\"id\":13,\"codigo\":\"MZCOL3\",\"nome\":\"COLUNA DO MEZANINO3\",\"linha\":\"MZCOL\",\"parametros\":[{\"Encoder\":4096}]},{\"id\":1,\"codigo\":\"COLN\",\"nome\":\"COLUNA N\",\"linha\":\"COLN\",\"parametros\":{}},{\"id\":3,\"codigo\":\"PPSIG\",\"nome\":\"PORTA PALETE SIGMA\",\"linha\":\"PPSIG\",\"parametros\":{}},{\"id\":5,\"codigo\":\"MZVIG\",\"nome\":\"VIGA DO MEZANINO\",\"linha\":\"MZVIG\",\"parametros\":{}}]  ","outputs":1,"noerr":0,"x":423.71429443359375,"y":178.5714340209961,"wires":[["e2035132.003f5"]]},{"id":"1ea0925b.801eee","type":"http in","z":"6e1cdd6e.93025c","name":"maquinas alterar","url":"/api/maquina/","method":"put","swaggerDoc":"","x":173.71429443359375,"y":258.5714340209961,"wires":[["69f4cdf4.ed9f74"]]},{"id":"599d869d.a3fab8","type":"http response","z":"6e1cdd6e.93025c","name":"","x":643.7142944335938,"y":258.5714340209961,"wires":[]},{"id":"69f4cdf4.ed9f74","type":"function","z":"6e1cdd6e.93025c","name":"SQL","func":"return msg;","outputs":1,"noerr":0,"x":423.71429443359375,"y":258.5714340209961,"wires":[["599d869d.a3fab8"]]},{"id":"12239c2f.f66a04","type":"http in","z":"6e1cdd6e.93025c","name":"maquinas incluir","url":"/api/maquina/","method":"post","swaggerDoc":"","x":173.71429443359375,"y":218.5714340209961,"wires":[["8bbe839e.6137"]]},{"id":"911313cd.172d8","type":"http response","z":"6e1cdd6e.93025c","name":"","x":643.7142944335938,"y":218.5714340209961,"wires":[]},{"id":"8bbe839e.6137","type":"function","z":"6e1cdd6e.93025c","name":"SQL","func":"return msg;","outputs":1,"noerr":0,"x":423.71429443359375,"y":218.5714340209961,"wires":[["911313cd.172d8"]]},{"id":"fa9e33fe.a503a","type":"function","z":"6e1cdd6e.93025c","name":"Lista de maquinas","func":"msg.payload = \n{\n\"_id\": \"Maquinas\",\n    \"Aplanadora-N3\": {\n      \"IP-IHM\" : \"192.168.2.230\",\n      \"IP-POP7\": \"192.168.2.235\",\n      \"IP-ESP8266\" : \"\",\n      \"Atualizacao\" : \"2017-03-09T11:44:56.224Z\",\n      \"parametros\": {\n          \"encoder\": {\n              \"fator\": 9998,\n              \"resolucao\": 2500,\n              \"perimetro\": 400\n          },\n          \"velocidade\": {\n              \"automatico\": 100,\n              \"manual\": 30\n          },\n          \"ferramenta\": {\n              \"passo\": 200\n          },\n          \"lubrificacao\": {\n              \"preset\": {\n                  \"MbNovoCiclos\": 100000\n              },\n              \"ciclos\": {\n                  \"PrsCiclos\": 5000\n              }\n          }\n      },\n      \"estado\": {\n          \"situacao\": {\n              \"codigo\": 4,\n              \"descricao\": \"Maquina OK\"\n          }\n      },\n      \"operadores\": {\n          \"IRANILDO\": {\n            \"md5\": \"93d8659ef7a80a65d1434366d96c8e13\"\n          },\n          \"MARCELO\": {\n            \"md5\": \"995bf053c4694e1e353cfd42b94e4447\"\n          }\n      },\n      \"os\": {\n          \"1231-11\": {\n            \"produto\": {\n                \"codigo\": \"XXXXXXXXX\",\n                \"descricao\": \"AAAAAABBBBBCCCCC\",\n                \"quantidade\": 1550,\n                \"produzido\": 299,\n                \"refugo\": 2\n            },\n            \"status\": \"produzindo\"\n          },\n          \"8792-55\": {\n            \"produto\": {\n                \"codigo\": \"XXXXXXXXX\",\n                \"descricao\": \"AAAAAABBBBBCCCCC\",\n                \"quantidade\": 700,\n                \"produzido\": 10,\n                \"refugo\": 10\n            },\n            \"status\": \"pendente\"\n          }\n      }\n    },\n    \"Perfiladeira-Reforço\": {\n      \"IP-IHM\" : \"192.168.2.220\",\n      \"IP-POP7\": \"192.168.2.211\",\n      \"IP-ESP8266\" : \"\",\n      \"Atualizacao\" : \"2015-02-10T11:22:08.224Z\",\n      \"parametros\": {\n          \"encoder\": {\n              \"fator\": 9998,\n              \"resolucao\": 2500,\n              \"perimetro\": 400\n          },\n          \"velocidade\": {\n              \"automatico\": 100,\n              \"manual\": 30\n          },\n          \"ferramenta\": {\n              \"passo\": 200\n          },\n          \"lubrificacao\": {\n              \"preset\": {\n                  \"MbNovoCiclos\": 100000\n              },\n              \"ciclos\": {\n                  \"PrsCiclos\": 5000\n              }\n          }\n      },\n      \"estado\": {\n          \"situacao\": {\n              \"codigo\": 1,\n              \"descricao\": \"Desligada\"\n          }\n      },\n      \"operadores\": {\n          \"IRANILDO\": {\n            \"md5\": \"93d8659ef7a80a65d1434366d96c8e13\"\n          },\n          \"MARCELO\": {\n            \"md5\": \"995bf053c4694e1e353cfd42b94e4447\"\n          }\n      },\n      \"os\": {\n          \"9999-44\": {\n            \"produto\": {\n                \"codigo\": \"QQQQQQQQQQQQ\",\n                \"descricao\": \"KKKKKKKBBBBBCCCCC\",\n                \"quantidade\": 350,\n                \"produzido\": 350,\n                \"refugo\": 0\n            },\n            \"status\": \"finalizado\"\n          },\n          \"6662-00\": {\n            \"produto\": {\n                \"codigo\": \"YYYYYYY\",\n                \"descricao\": \"GGGGGGBBBBBCCCCC\",\n                \"quantidade\": 150,\n                \"produzido\": 155,\n                \"refugo\": 5\n            },\n            \"status\": \"finalizado\"\n          }\n      }\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":457.71429443359375,"y":479.5714340209961,"wires":[["52fe9e32.0fac2"]]},{"id":"52fe9e32.0fac2","type":"debug","z":"6e1cdd6e.93025c","name":"","active":true,"console":"false","complete":"false","x":693.2142944335938,"y":480.5714340209961,"wires":[]},{"id":"a4a5db9d.648798","type":"inject","z":"6e1cdd6e.93025c","name":"mostrar JSON","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":233.21429443359375,"y":480.5714340209961,"wires":[["fa9e33fe.a503a"]]},{"id":"6ce018bc.1db698","type":"http in","z":"6e1cdd6e.93025c","name":"login","url":"/api/usuario/login","method":"post","swaggerDoc":"","x":191.71429443359375,"y":766.5714340209961,"wires":[["c50601c1.718e2","8ae53ca1.a31e7"]]},{"id":"17fb7726.cd2f69","type":"http response","z":"6e1cdd6e.93025c","name":"","x":669.7142944335938,"y":766.5714340209961,"wires":[]},{"id":"904305d0.e512c8","type":"http in","z":"6e1cdd6e.93025c","name":"config","url":"/api/maquina/config","method":"get","swaggerDoc":"","x":191.71429443359375,"y":721.5714340209961,"wires":[["8d2e240f.e24ab8","8e1e1701.47ab68"]]},{"id":"8d2e240f.e24ab8","type":"function","z":"6e1cdd6e.93025c","name":"json","func":"msg.payload = {\n    id: 123,\n    codigo: 'PERF-N3',\n    nome: 'Cantoneira N3',\n    path: 'maquinas/perfiladeiras/n3'\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":451.71429443359375,"y":721.5714340209961,"wires":[["ae997d5f.cdebc","964f64ff.539ef8"]]},{"id":"ae997d5f.cdebc","type":"http response","z":"6e1cdd6e.93025c","name":"","x":671.7142944335938,"y":721.5714340209961,"wires":[]},{"id":"c50601c1.718e2","type":"debug","z":"6e1cdd6e.93025c","name":"disparo ","active":true,"console":"false","complete":"payload","x":379.21429443359375,"y":816.5714340209961,"wires":[]},{"id":"7b10a930.c678c8","type":"debug","z":"6e1cdd6e.93025c","name":"resposta SQL","active":true,"console":"false","complete":"payload","x":678.7142944335938,"y":814.5714340209961,"wires":[]},{"id":"8ae53ca1.a31e7","type":"function","z":"6e1cdd6e.93025c","name":"senha","func":"\nvar msg2 = {};\nmsg2.payload = msg.payload.senha;\n\nmsg.payload = {\n    id: 123,\n    usuario: 'rita',\n    senha: '2794d223f90059c9f705c73a99384085',\n    nome: 'rita'\n};\n\nreturn [msg,msg2];","outputs":"2","noerr":0,"x":447.71429443359375,"y":770.5714340209961,"wires":[["17fb7726.cd2f69","7b10a930.c678c8"],[]]},{"id":"964f64ff.539ef8","type":"debug","z":"6e1cdd6e.93025c","name":"resposta mongo config","active":true,"console":"false","complete":"payload","x":709.7142944335938,"y":672.5714340209961,"wires":[]},{"id":"8e1e1701.47ab68","type":"debug","z":"6e1cdd6e.93025c","name":"IHM pedindo config","active":true,"console":"false","complete":"payload","x":411.71429443359375,"y":676.5714340209961,"wires":[]},{"id":"bf4d7693.b5a9e8","type":"comment","z":"6e1cdd6e.93025c","name":"Node-red Local","info":"","x":220.21429443359375,"y":619.5714340209961,"wires":[]},{"id":"66f66c9a.bdb4a4","type":"debug","z":"6e1cdd6e.93025c","name":"","active":true,"console":"false","complete":"true","x":423.71429443359375,"y":318.5714340209961,"wires":[]}]